openapi: 3.1.0

info:
  title: token.prim.sh API
  version: 1.0.0
  description: |
    ERC-20 token deployment and management for agents. Deploy tokens, mint supply, and create Uniswap V3 liquidity pools with x402 payment (USDC on Base).

    ## Authentication

    All endpoints except `GET /` and `GET /llms.txt` require x402 payment. The flow:
    1. Make the request — server responds with `402 Payment Required` and a payment challenge.
    2. Sign the EIP-3009 payment authorization with your wallet.
    3. Retry the request with the `Payment-Signature` header set to the signed authorization.

    The wallet address extracted from the payment signature becomes the caller identity (owner of tokens).

    ## Token amounts

    All token amounts (`initial_supply`, `max_supply`, `amount`, `total_supply`, etc.) are strings representing raw
    integer values in the token's smallest unit (like wei). This avoids JavaScript BigInt precision loss.
    For a token with 18 decimals, 1 token = "1000000000000000000".

    ## Async operations

    Token deployment and minting are asynchronous — the server submits the transaction and returns
    immediately with `deploy_status: "pending"`. Poll `GET /v1/tokens/{id}` until `deploy_status` is
    `"confirmed"` before minting or creating a pool. Expected confirmation time is 1–5 seconds on Base.

servers:
  - url: https://token.prim.sh

components:
  securitySchemes:
    x402:
      type: apiKey
      in: header
      name: Payment-Signature
      description: |
        EIP-3009 signed payment authorization. Server issues a 402 challenge; client signs and retries.
        See https://prim.sh/pay for the full x402 payment flow.

  schemas:
    Error:
      type: object
      required: [error]
      properties:
        error:
          type: object
          required: [code, message]
          properties:
            code:
              type: string
              enum:
                - not_found
                - forbidden
                - invalid_request
                - not_mintable
                - exceeds_max_supply
                - pool_exists
                - rpc_error
              description: Machine-readable error code.
            message:
              type: string
              description: Human-readable error message.

    TokenResponse:
      type: object
      required:
        - id
        - contract_address
        - owner_wallet
        - name
        - symbol
        - decimals
        - initial_supply
        - total_minted
        - mintable
        - max_supply
        - tx_hash
        - deploy_status
        - created_at
      properties:
        id:
          type: string
          description: Unique token identifier (e.g. "tk_abc1234f").
          example: "tk_a1b2c3d4"
        contract_address:
          type: ["string", "null"]
          description: Deployed contract address. null while deploy_status is "pending".
          example: "0xAbCd1234567890abcdef1234567890abCDEF1234"
        owner_wallet:
          type: string
          pattern: "^0x[a-fA-F0-9]{40}$"
          description: Ethereum address of the wallet that deployed this token.
          example: "0xDeAd1234567890abcdef1234567890abCDEF5678"
        name:
          type: string
          description: Token name (e.g. "MyToken").
          example: "MyToken"
        symbol:
          type: string
          description: Token ticker symbol (uppercase alphanumeric, 1–11 chars).
          example: "MTK"
        decimals:
          type: integer
          description: Number of decimal places (default 18).
          example: 18
        initial_supply:
          type: string
          description: Initial supply in raw token units (string to avoid BigInt precision loss).
          example: "1000000000000000000000000"
        total_minted:
          type: string
          description: Total tokens minted so far in raw units.
          example: "1000000000000000000000000"
        mintable:
          type: boolean
          description: Whether additional tokens can be minted after deploy.
          example: true
        max_supply:
          type: ["string", "null"]
          description: Maximum mintable supply in raw units. null = no cap.
          example: "10000000000000000000000000"
        tx_hash:
          type: string
          description: Transaction hash of the deploy transaction.
          example: "0xabc123def456789abc123def456789abc123def456789abc123def456789abc1"
        deploy_status:
          type: string
          enum: ["pending", "confirmed", "failed"]
          description: Current deployment status. Poll until "confirmed" before minting or creating a pool.
          example: "confirmed"
        created_at:
          type: string
          format: date-time
          description: ISO 8601 timestamp of token creation.
          example: "2026-02-26T12:00:00.000Z"

    MintResponse:
      type: object
      required: [tx_hash, to, amount, status]
      properties:
        tx_hash:
          type: string
          description: Transaction hash of the mint transaction.
          example: "0xdef456abc123789def456abc123789def456abc123789def456abc123789def4"
        to:
          type: string
          pattern: "^0x[a-fA-F0-9]{40}$"
          description: Recipient address.
          example: "0xAbCd1234567890abcdef1234567890abCDEF1234"
        amount:
          type: string
          description: Amount minted in raw token units.
          example: "500000000000000000000"
        status:
          type: string
          enum: ["pending"]
          description: Always "pending" — mint is submitted but not yet confirmed on-chain.
          example: "pending"

    SupplyResponse:
      type: object
      required: [token_id, contract_address, total_supply]
      properties:
        token_id:
          type: string
          description: Token identifier.
          example: "tk_a1b2c3d4"
        contract_address:
          type: string
          description: Deployed contract address.
          example: "0xAbCd1234567890abcdef1234567890abCDEF1234"
        total_supply:
          type: string
          description: Live on-chain total supply in raw token units.
          example: "1500000000000000000000000"

    PoolResponse:
      type: object
      required: [pool_address, token0, token1, fee, sqrt_price_x96, tick, tx_hash]
      properties:
        pool_address:
          type: string
          description: Address of the created Uniswap V3 pool.
          example: "0x1234AbCd5678EFab1234AbCd5678EFab1234AbCd"
        token0:
          type: string
          description: Address of token0 in the pool pair.
          example: "0xAbCd1234567890abcdef1234567890abCDEF1234"
        token1:
          type: string
          description: Address of token1 in the pool pair (typically USDC).
          example: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
        fee:
          type: integer
          description: Pool fee tier in hundredths of a basis point (e.g. 3000 = 0.3%).
          example: 3000
        sqrt_price_x96:
          type: string
          description: Initial sqrt price as Q64.96 fixed-point (string for BigInt precision).
          example: "79228162514264337593543950336"
        tick:
          type: integer
          description: Current tick at pool initialization.
          example: 0
        tx_hash:
          type: string
          description: Transaction hash of the pool creation transaction.
          example: "0x789abc123def456789abc123def456789abc123def456789abc123def456789a"

    LiquidityApproval:
      type: object
      required: [token, spender, amount]
      properties:
        token:
          type: string
          description: Token contract address to approve.
          example: "0xAbCd1234567890abcdef1234567890abCDEF1234"
        spender:
          type: string
          description: Spender address (position manager) to approve.
          example: "0xC36442b4a4522E871399CD717aBDD847Ab11FE88"
        amount:
          type: string
          description: Amount to approve in raw token units.
          example: "1000000000000000000000"

    LiquidityParamsResponse:
      type: object
      required:
        - position_manager_address
        - token0
        - token1
        - fee
        - tick_lower
        - tick_upper
        - amount0_desired
        - amount1_desired
        - amount0_min
        - amount1_min
        - recipient
        - deadline
        - approvals
      properties:
        position_manager_address:
          type: string
          description: Uniswap V3 NonfungiblePositionManager contract address.
          example: "0xC36442b4a4522E871399CD717aBDD847Ab11FE88"
        token0:
          type: string
          description: Address of token0.
          example: "0xAbCd1234567890abcdef1234567890abCDEF1234"
        token1:
          type: string
          description: Address of token1 (typically USDC).
          example: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
        fee:
          type: integer
          description: Pool fee tier.
          example: 3000
        tick_lower:
          type: integer
          description: Lower tick boundary for the liquidity position.
          example: -887220
        tick_upper:
          type: integer
          description: Upper tick boundary for the liquidity position.
          example: 887220
        amount0_desired:
          type: string
          description: Desired amount of token0 to add in raw units.
          example: "1000000000000000000000"
        amount1_desired:
          type: string
          description: Desired amount of token1 (USDC) to add in raw units.
          example: "1000000"
        amount0_min:
          type: string
          description: Minimum amount of token0 (slippage protection).
          example: "990000000000000000000"
        amount1_min:
          type: string
          description: Minimum amount of token1 (slippage protection).
          example: "990000"
        recipient:
          type: string
          description: Address to receive the LP NFT position.
          example: "0xDeAd1234567890abcdef1234567890abCDEF5678"
        deadline:
          type: integer
          description: Unix timestamp after which the transaction reverts.
          example: 1740600000
        approvals:
          type: array
          description: Token approvals to submit on-chain before calling addLiquidity.
          items:
            $ref: "#/components/schemas/LiquidityApproval"

paths:
  /:
    get:
      operationId: healthCheck
      summary: Health check
      description: Returns service status. Free — no x402 payment required.
      security: []
      responses:
        "200":
          description: Service is running.
          content:
            application/json:
              schema:
                type: object
                required: [service, status]
                properties:
                  service:
                    type: string
                    example: "token.sh"
                  status:
                    type: string
                    example: "ok"
              example:
                service: "token.sh"
                status: "ok"

  /llms.txt:
    get:
      operationId: getLlmsTxt
      summary: Machine-readable API reference
      description: Returns a plain-text API reference optimized for LLM consumption. Free — no x402 payment required.
      security: []
      responses:
        "200":
          description: llms.txt content.
          content:
            text/plain:
              schema:
                type: string

  /v1/tokens:
    post:
      operationId: deployToken
      summary: Deploy ERC-20 token
      description: |
        Deploys a new ERC-20 token contract to Base. The token is owned by the paying wallet.

        Deployment is asynchronous — the response returns immediately with `deploy_status: "pending"`.
        Poll `GET /v1/tokens/{id}` until `deploy_status` is `"confirmed"` before minting or creating a pool.
        Expected confirmation time on Base is 1–5 seconds.
      security:
        - x402: []
      x-price: "$1.00"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, symbol, initialSupply]
              properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 64
                  description: Token name.
                  example: "MyToken"
                symbol:
                  type: string
                  minLength: 1
                  maxLength: 11
                  pattern: "^[A-Z0-9]+$"
                  description: Token ticker symbol (uppercase alphanumeric, 1–11 chars).
                  example: "MTK"
                decimals:
                  type: integer
                  minimum: 0
                  maximum: 18
                  description: Decimal places (default 18). Most ERC-20 tokens use 18.
                  default: 18
                  example: 18
                initialSupply:
                  type: string
                  description: Initial supply in raw token units. For 1M tokens with 18 decimals, pass "1000000000000000000000000".
                  example: "1000000000000000000000000"
                mintable:
                  type: boolean
                  description: Whether additional tokens can be minted after deploy (default false). Immutable after deployment.
                  default: false
                  example: true
                maxSupply:
                  type: ["string", "null"]
                  description: Maximum mintable supply in raw units. null or omit for no cap. Only meaningful if mintable is true.
                  example: "10000000000000000000000000"
            example:
              name: "MyToken"
              symbol: "MTK"
              decimals: 18
              initialSupply: "1000000000000000000000000"
              mintable: true
              maxSupply: "10000000000000000000000000"
      responses:
        "201":
          description: Token deploy submitted.
          content:
            application/json:
              schema:
                type: object
                required: [token]
                properties:
                  token:
                    $ref: "#/components/schemas/TokenResponse"
              example:
                token:
                  id: "tk_a1b2c3d4"
                  contract_address: null
                  owner_wallet: "0xDeAd1234567890abcdef1234567890abCDEF5678"
                  name: "MyToken"
                  symbol: "MTK"
                  decimals: 18
                  initial_supply: "1000000000000000000000000"
                  total_minted: "1000000000000000000000000"
                  mintable: true
                  max_supply: "10000000000000000000000000"
                  tx_hash: "0xabc123def456789abc123def456789abc123def456789abc123def456789abc1"
                  deploy_status: "pending"
                  created_at: "2026-02-26T12:00:00.000Z"
        "400":
          description: Invalid request body.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "invalid_request"
                  message: "initialSupply is required"
        "402":
          description: x402 payment required.
        "403":
          description: Missing wallet address in payment.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "No wallet address in payment"
        "502":
          description: RPC error communicating with Base.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "rpc_error"
                  message: "Deploy failed: connection refused"

    get:
      operationId: listTokens
      summary: List tokens
      description: |
        Returns all tokens deployed by the paying wallet.

        Pagination is page-based. Default page size is 20, maximum is 100.
      security:
        - x402: []
      x-price: "$0.001"
      parameters:
        - name: limit
          in: query
          description: Number of tokens per page (1–100, default 20).
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          example: 20
        - name: page
          in: query
          description: Page number (1-based, default 1).
          schema:
            type: integer
            minimum: 1
            default: 1
          example: 1
      responses:
        "200":
          description: List of tokens.
          content:
            application/json:
              schema:
                type: object
                required: [tokens, meta]
                properties:
                  tokens:
                    type: array
                    items:
                      $ref: "#/components/schemas/TokenResponse"
                  meta:
                    type: object
                    required: [page, per_page, total]
                    properties:
                      page:
                        type: integer
                        description: Current page number.
                        example: 1
                      per_page:
                        type: integer
                        description: Number of items per page.
                        example: 20
                      total:
                        type: integer
                        description: Total number of tokens.
                        example: 2
              example:
                tokens:
                  - id: "tk_a1b2c3d4"
                    contract_address: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                    owner_wallet: "0xDeAd1234567890abcdef1234567890abCDEF5678"
                    name: "MyToken"
                    symbol: "MTK"
                    decimals: 18
                    initial_supply: "1000000000000000000000000"
                    total_minted: "1000000000000000000000000"
                    mintable: true
                    max_supply: "10000000000000000000000000"
                    tx_hash: "0xabc123def456789abc123def456789abc123def456789abc123def456789abc1"
                    deploy_status: "confirmed"
                    created_at: "2026-02-26T12:00:00.000Z"
                meta:
                  page: 1
                  per_page: 20
                  total: 1
        "402":
          description: x402 payment required.
        "403":
          description: Missing wallet address in payment.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "No wallet address in payment"

  /v1/tokens/{id}:
    get:
      operationId: getToken
      summary: Get token details
      description: |
        Returns details for a single token. Caller must own the token.
        Poll this endpoint until `deploy_status` is `"confirmed"` before minting or creating a pool.
      security:
        - x402: []
      x-price: "$0.001"
      parameters:
        - name: id
          in: path
          required: true
          description: Token ID.
          schema:
            type: string
          example: "tk_a1b2c3d4"
      responses:
        "200":
          description: Token details.
          content:
            application/json:
              schema:
                type: object
                required: [token]
                properties:
                  token:
                    $ref: "#/components/schemas/TokenResponse"
              example:
                token:
                  id: "tk_a1b2c3d4"
                  contract_address: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                  owner_wallet: "0xDeAd1234567890abcdef1234567890abCDEF5678"
                  name: "MyToken"
                  symbol: "MTK"
                  decimals: 18
                  initial_supply: "1000000000000000000000000"
                  total_minted: "1000000000000000000000000"
                  mintable: true
                  max_supply: "10000000000000000000000000"
                  tx_hash: "0xabc123def456789abc123def456789abc123def456789abc123def456789abc1"
                  deploy_status: "confirmed"
                  created_at: "2026-02-26T12:00:00.000Z"
        "402":
          description: x402 payment required.
        "403":
          description: Token belongs to a different wallet.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "Forbidden"
        "404":
          description: Token not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "not_found"
                  message: "Token not found"

  /v1/tokens/{id}/mint:
    post:
      operationId: mintTokens
      summary: Mint additional tokens
      description: |
        Mints additional tokens to a recipient address. The token must be `mintable: true`
        (set at deploy time — immutable after deployment) and the mint must not exceed
        `max_supply` (if set). Caller must own the token.

        The token must have `deploy_status: "confirmed"` before minting.
        Minting is asynchronous — the response returns with `status: "pending"`.
        Expected confirmation time on Base is 1–5 seconds.
      security:
        - x402: []
      x-price: "$0.10"
      parameters:
        - name: id
          in: path
          required: true
          description: Token ID.
          schema:
            type: string
          example: "tk_a1b2c3d4"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [to, amount]
              properties:
                to:
                  type: string
                  pattern: "^0x[a-fA-F0-9]{40}$"
                  description: Recipient Ethereum address.
                  example: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                amount:
                  type: string
                  description: Amount to mint in raw token units.
                  example: "500000000000000000000"
            example:
              to: "0xAbCd1234567890abcdef1234567890abCDEF1234"
              amount: "500000000000000000000"
      responses:
        "200":
          description: Mint submitted.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MintResponse"
              example:
                tx_hash: "0xdef456abc123789def456abc123789def456abc123789def456abc123789def4"
                to: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                amount: "500000000000000000000"
                status: "pending"
        "400":
          description: Invalid request or token is not mintable.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                not_mintable:
                  value:
                    error:
                      code: "not_mintable"
                      message: "Token is not mintable"
                invalid_request:
                  value:
                    error:
                      code: "invalid_request"
                      message: "to must be a valid Ethereum address"
        "402":
          description: x402 payment required.
        "403":
          description: Token belongs to a different wallet.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "Forbidden"
        "404":
          description: Token not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "not_found"
                  message: "Token not found"
        "422":
          description: Mint would exceed max_supply.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "exceeds_max_supply"
                  message: "Mint would exceed maximum supply"
        "502":
          description: RPC error communicating with Base.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "rpc_error"
                  message: "Mint failed: transaction reverted"

  /v1/tokens/{id}/supply:
    get:
      operationId: getTokenSupply
      summary: Get total supply
      description: |
        Returns the live on-chain total supply by querying the contract directly.
        Caller must own the token. Token must have `deploy_status: "confirmed"`.
      security:
        - x402: []
      x-price: "$0.001"
      parameters:
        - name: id
          in: path
          required: true
          description: Token ID.
          schema:
            type: string
          example: "tk_a1b2c3d4"
      responses:
        "200":
          description: Current total supply.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SupplyResponse"
              example:
                token_id: "tk_a1b2c3d4"
                contract_address: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                total_supply: "1500000000000000000000000"
        "400":
          description: Token contract not yet deployed (deploy_status is "pending").
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "invalid_request"
                  message: "Token contract not yet deployed (status: pending)"
        "402":
          description: x402 payment required.
        "403":
          description: Token belongs to a different wallet.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "Forbidden"
        "404":
          description: Token not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "not_found"
                  message: "Token not found"
        "502":
          description: RPC error communicating with Base.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "rpc_error"
                  message: "Supply read failed: connection refused"

  /v1/tokens/{id}/pool:
    post:
      operationId: createPool
      summary: Create Uniswap V3 pool
      description: |
        Creates and initializes a Uniswap V3 pool for the token paired with USDC.
        Only one pool can exist per token (409 if called again). Caller must own the token.

        The token must have `deploy_status: "confirmed"` before creating a pool.

        After creating the pool, call `GET /v1/tokens/{id}/pool/liquidity-params` to get
        the calldata for adding liquidity to the pool.
      security:
        - x402: []
      x-price: "$0.50"
      parameters:
        - name: id
          in: path
          required: true
          description: Token ID.
          schema:
            type: string
          example: "tk_a1b2c3d4"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [pricePerToken]
              properties:
                pricePerToken:
                  type: string
                  description: Initial price in USDC per token as a decimal string (e.g. "0.001" for 0.1 cents per token).
                  example: "0.001"
                feeTier:
                  type: integer
                  description: Uniswap V3 fee tier in hundredths of a basis point. Valid values are 500 (0.05%), 3000 (0.3%), 10000 (1%). Default 3000.
                  enum: [500, 3000, 10000]
                  default: 3000
                  example: 3000
            example:
              pricePerToken: "0.001"
              feeTier: 3000
      responses:
        "201":
          description: Pool created.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PoolResponse"
              example:
                pool_address: "0x1234AbCd5678EFab1234AbCd5678EFab1234AbCd"
                token0: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                token1: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
                fee: 3000
                sqrt_price_x96: "79228162514264337593543950336"
                tick: 0
                tx_hash: "0x789abc123def456789abc123def456789abc123def456789abc123def456789a"
        "400":
          description: Invalid request or token not yet confirmed.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "invalid_request"
                  message: "pricePerToken must be a positive decimal string"
        "402":
          description: x402 payment required.
        "403":
          description: Token belongs to a different wallet.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "Forbidden"
        "404":
          description: Token not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "not_found"
                  message: "Token not found"
        "409":
          description: Pool already exists for this token.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "pool_exists"
                  message: "A pool already exists for this token"
        "502":
          description: RPC error communicating with Base.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "rpc_error"
                  message: "Pool creation failed: transaction reverted"

    get:
      operationId: getPool
      summary: Get pool details
      description: Returns details for the Uniswap V3 pool associated with the token. Caller must own the token.
      security:
        - x402: []
      x-price: "$0.001"
      parameters:
        - name: id
          in: path
          required: true
          description: Token ID.
          schema:
            type: string
          example: "tk_a1b2c3d4"
      responses:
        "200":
          description: Pool details.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PoolResponse"
              example:
                pool_address: "0x1234AbCd5678EFab1234AbCd5678EFab1234AbCd"
                token0: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                token1: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
                fee: 3000
                sqrt_price_x96: "79228162514264337593543950336"
                tick: 0
                tx_hash: "0x789abc123def456789abc123def456789abc123def456789abc123def456789a"
        "402":
          description: x402 payment required.
        "403":
          description: Token belongs to a different wallet.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "Forbidden"
        "404":
          description: Token or pool not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                token_not_found:
                  value:
                    error:
                      code: "not_found"
                      message: "Token not found"
                pool_not_found:
                  value:
                    error:
                      code: "not_found"
                      message: "No pool exists for this token"

  /v1/tokens/{id}/pool/liquidity-params:
    get:
      operationId: getLiquidityParams
      summary: Get liquidity parameters
      description: |
        Returns the calldata parameters for adding liquidity to the token's Uniswap V3 pool.
        Also returns required token approvals to submit on-chain before calling addLiquidity.

        Caller must own the token and the pool must already exist.

        Workflow:
        1. Call `POST /v1/tokens/{id}/pool` to create the pool.
        2. Call this endpoint with `tokenAmount` and `usdcAmount` to get the calldata.
        3. Submit the `approvals[]` transactions on-chain.
        4. Call the Uniswap V3 NonfungiblePositionManager `mint()` with the returned params.
      security:
        - x402: []
      x-price: "$0.001"
      parameters:
        - name: id
          in: path
          required: true
          description: Token ID.
          schema:
            type: string
          example: "tk_a1b2c3d4"
        - name: tokenAmount
          in: query
          required: true
          description: Amount of tokens to add as liquidity in raw units.
          schema:
            type: string
          example: "1000000000000000000000"
        - name: usdcAmount
          in: query
          required: true
          description: Amount of USDC to add as liquidity in raw units (USDC has 6 decimals, so $1 = "1000000").
          schema:
            type: string
          example: "1000000"
      responses:
        "200":
          description: Liquidity parameters and required approvals.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LiquidityParamsResponse"
              example:
                position_manager_address: "0xC36442b4a4522E871399CD717aBDD847Ab11FE88"
                token0: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                token1: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
                fee: 3000
                tick_lower: -887220
                tick_upper: 887220
                amount0_desired: "1000000000000000000000"
                amount1_desired: "1000000"
                amount0_min: "990000000000000000000"
                amount1_min: "990000"
                recipient: "0xDeAd1234567890abcdef1234567890abCDEF5678"
                deadline: 1740600000
                approvals:
                  - token: "0xAbCd1234567890abcdef1234567890abCDEF1234"
                    spender: "0xC36442b4a4522E871399CD717aBDD847Ab11FE88"
                    amount: "1000000000000000000000"
                  - token: "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
                    spender: "0xC36442b4a4522E871399CD717aBDD847Ab11FE88"
                    amount: "1000000"
        "400":
          description: Invalid tokenAmount or usdcAmount.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                missing_token_amount:
                  value:
                    error:
                      code: "invalid_request"
                      message: "tokenAmount must be a positive number"
                missing_usdc_amount:
                  value:
                    error:
                      code: "invalid_request"
                      message: "usdcAmount must be a positive number"
        "402":
          description: x402 payment required.
        "403":
          description: Token belongs to a different wallet.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              example:
                error:
                  code: "forbidden"
                  message: "Forbidden"
        "404":
          description: Token or pool not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
              examples:
                token_not_found:
                  value:
                    error:
                      code: "not_found"
                      message: "Token not found"
                pool_not_found:
                  value:
                    error:
                      code: "not_found"
                      message: "No pool exists for this token"
