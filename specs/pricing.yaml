# Master Pricing Table — Source of Truth
# All x402 prices in USDC on Base. Provider costs are monthly or per-call as noted.
# Margin = (price - cost) / price * 100. Negative = loss leader.
#
# Updated: 2026-02-26

primitives:

  - name: wallet.sh
    description: Non-custodial wallet registration + policy management
    free_routes:
      - "GET /"
      - "POST /v1/wallets"
    paid_routes:
      - endpoint: "GET /v1/wallets"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "GET /v1/wallets/{address}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "DELETE /v1/wallets/{address}"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite delete"
      - endpoint: "GET /v1/wallets/{address}/fund-requests"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "POST /v1/wallets/{address}/fund-request"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "POST /v1/fund-requests/{id}/approve"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write + allowlist update"
      - endpoint: "POST /v1/fund-requests/{id}/deny"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "GET /v1/wallets/{address}/policy"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "PUT /v1/wallets/{address}/policy"
        x402_price: "$0.005"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "POST /v1/wallets/{address}/pause"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "POST /v1/wallets/{address}/resume"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"

  - name: store.sh
    description: Object storage via Cloudflare R2
    free_routes:
      - "GET /"
    paid_routes:
      - endpoint: "POST /v1/buckets"
        x402_price: "$0.05"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "R2 bucket create (free tier), SQLite write"
      - endpoint: "GET /v1/buckets"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "GET /v1/buckets/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "DELETE /v1/buckets/{id}"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "R2 delete + SQLite write"
      - endpoint: "PUT /v1/buckets/{id}/objects/*"
        x402_price: "$0.001"
        provider_cost: "$0.0000045"
        margin_pct: 99
        notes: "R2 Class A op ($4.50/M)"
      - endpoint: "GET /v1/buckets/{id}/objects"
        x402_price: "$0.001"
        provider_cost: "$0.00000036"
        margin_pct: 99
        notes: "R2 Class B op ($0.36/M)"
      - endpoint: "GET /v1/buckets/{id}/objects/*"
        x402_price: "$0.001"
        provider_cost: "$0.00000036"
        margin_pct: 99
        notes: "R2 Class B op ($0.36/M)"
      - endpoint: "DELETE /v1/buckets/{id}/objects/*"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "R2 delete (free)"
      - endpoint: "GET /v1/buckets/{id}/quota"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "PUT /v1/buckets/{id}/quota"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "POST /v1/buckets/{id}/quota/reconcile"
        x402_price: "$0.05"
        provider_cost: "$0.0000045"
        margin_pct: 99
        notes: "R2 list + SQLite write"

  - name: spawn.sh
    description: VPS provisioning via DigitalOcean
    free_routes:
      - "GET /"
    paid_routes:
      - endpoint: "POST /v1/servers"
        x402_price: "$0.01"
        provider_cost: "$4.00"
        margin_pct: -39900
        notes: "RISK: $0.01 one-time charge vs $4/mo DO droplet. Needs recurring billing model"
      - endpoint: "GET /v1/servers"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "GET /v1/servers/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API read (free)"
      - endpoint: "DELETE /v1/servers/{id}"
        x402_price: "$0.005"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API destroy (stops billing)"
      - endpoint: "POST /v1/servers/{id}/start"
        x402_price: "$0.002"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API power on"
      - endpoint: "POST /v1/servers/{id}/stop"
        x402_price: "$0.002"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API power off"
      - endpoint: "POST /v1/servers/{id}/reboot"
        x402_price: "$0.002"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API reboot"
      - endpoint: "POST /v1/servers/{id}/resize"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API resize (cost change reflected in monthly)"
      - endpoint: "POST /v1/servers/{id}/rebuild"
        x402_price: "$0.005"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API rebuild"
      - endpoint: "POST /v1/ssh-keys"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API key register"
      - endpoint: "GET /v1/ssh-keys"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "DELETE /v1/ssh-keys/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DO API key delete"

  - name: email.sh
    description: Email infrastructure via Stalwart Mail Server
    free_routes:
      - "GET /"
      - "GET /llms.txt"
      - "POST /internal/hooks/ingest"
    paid_routes:
      - endpoint: "POST /v1/mailboxes"
        x402_price: "$0.05"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Stalwart REST + SQLite (self-hosted, fixed infra cost)"
      - endpoint: "GET /v1/mailboxes"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "GET /v1/mailboxes/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "DELETE /v1/mailboxes/{id}"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Stalwart REST + SQLite"
      - endpoint: "POST /v1/mailboxes/{id}/renew"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "GET /v1/mailboxes/{id}/messages"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "JMAP query"
      - endpoint: "GET /v1/mailboxes/{id}/messages/{msgId}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "JMAP get"
      - endpoint: "POST /v1/mailboxes/{id}/send"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "JMAP EmailSubmission"
      - endpoint: "POST /v1/mailboxes/{id}/webhooks"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "GET /v1/mailboxes/{id}/webhooks"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "DELETE /v1/mailboxes/{id}/webhooks/{whId}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite delete"
      - endpoint: "POST /v1/domains"
        x402_price: "$0.05"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Stalwart domain provisioning"
      - endpoint: "GET /v1/domains"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "GET /v1/domains/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "POST /v1/domains/{id}/verify"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DNS lookup + SQLite"
      - endpoint: "DELETE /v1/domains/{id}"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Stalwart REST + SQLite"

  - name: search.sh
    description: Web search via Tavily API
    free_routes:
      - "GET /"
    paid_routes:
      - endpoint: "POST /v1/search"
        x402_price: "$0.01"
        provider_cost: "$0.005"
        margin_pct: 50
        notes: "Tavily search ($5/1K calls)"
      - endpoint: "POST /v1/search/news"
        x402_price: "$0.01"
        provider_cost: "$0.005"
        margin_pct: 50
        notes: "Tavily search ($5/1K calls)"
      - endpoint: "POST /v1/extract"
        x402_price: "$0.005"
        provider_cost: "$0.005"
        margin_pct: 0
        notes: "RISK: Tavily extract at cost — 0% margin"

  - name: faucet.sh
    description: Testnet USDC + ETH faucet (free, rate-limited)
    free_routes:
      - "GET /"
      - "POST /v1/faucet/usdc"
      - "POST /v1/faucet/eth"
      - "GET /v1/faucet/status"
    paid_routes: []
    notes: "All endpoints free. Rate-limited per address. Testnet only."

  - name: token.sh
    description: ERC-20 token deployment + Uniswap V3 pools
    free_routes:
      - "GET /"
      - "GET /llms.txt"
    paid_routes:
      - endpoint: "POST /v1/tokens"
        x402_price: "$1.00"
        provider_cost: "$0.10"
        margin_pct: 90
        notes: "On-chain deploy gas. RISK: mainnet gas spikes can exceed $1 in congestion"
      - endpoint: "GET /v1/tokens"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "GET /v1/tokens/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "POST /v1/tokens/{id}/mint"
        x402_price: "$0.10"
        provider_cost: "$0.01"
        margin_pct: 90
        notes: "On-chain mint gas"
      - endpoint: "GET /v1/tokens/{id}/supply"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "On-chain read (free RPC call)"
      - endpoint: "POST /v1/tokens/{id}/pool"
        x402_price: "$0.50"
        provider_cost: "$0.05"
        margin_pct: 90
        notes: "Uniswap V3 createPool + initialize gas"
      - endpoint: "GET /v1/tokens/{id}/pool"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "On-chain read (free RPC call)"
      - endpoint: "GET /v1/tokens/{id}/pool/liquidity-params"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Computed calldata, no on-chain call"

  - name: mem.sh
    description: Vector memory (Qdrant) + KV cache
    free_routes:
      - "GET /"
      - "GET /llms.txt"
    paid_routes:
      - endpoint: "POST /v1/collections"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Qdrant create collection (self-hosted)"
      - endpoint: "GET /v1/collections"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Qdrant list"
      - endpoint: "GET /v1/collections/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Qdrant get info"
      - endpoint: "DELETE /v1/collections/{id}"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Qdrant delete collection"
      - endpoint: "POST /v1/collections/{id}/upsert"
        x402_price: "$0.001"
        provider_cost: "$0.0001"
        margin_pct: 90
        notes: "Google embedding API (~$0.10/M chars) + Qdrant upsert"
      - endpoint: "POST /v1/collections/{id}/query"
        x402_price: "$0.001"
        provider_cost: "$0.0001"
        margin_pct: 90
        notes: "Google embedding API + Qdrant search"
      - endpoint: "PUT /v1/cache/{namespace}/{key}"
        x402_price: "$0.0001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "GET /v1/cache/{namespace}/{key}"
        x402_price: "$0.0001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "DELETE /v1/cache/{namespace}/{key}"
        x402_price: "$0.0001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite delete"

  - name: domain.sh
    description: DNS zones + domain registration via Cloudflare + NameSilo
    free_routes:
      - "GET /"
      - "GET /llms.txt"
      - "POST /v1/domains/recover"
      - "POST /v1/domains/{domain}/configure-ns"
    paid_routes:
      - endpoint: "GET /v1/domains/search"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "NameSilo availability API (free)"
      - endpoint: "POST /v1/domains/quote"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "NameSilo price lookup (free)"
      - endpoint: "POST /v1/domains/register"
        x402_price: "dynamic"
        provider_cost: "varies"
        margin_pct: "varies"
        notes: "NameSilo registration ($8-40/yr depending on TLD). Price quoted via /quote endpoint"
      - endpoint: "GET /v1/domains/{domain}/status"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "POST /v1/zones"
        x402_price: "$0.05"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare zone create (free plan)"
      - endpoint: "GET /v1/zones"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "GET /v1/zones/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite read"
      - endpoint: "DELETE /v1/zones/{id}"
        x402_price: "$0.01"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare API + SQLite"
      - endpoint: "PUT /v1/zones/{zone_id}/activate"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "SQLite write"
      - endpoint: "GET /v1/zones/{zone_id}/verify"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "DNS lookup"
      - endpoint: "POST /v1/zones/{zone_id}/mail-setup"
        x402_price: "$0.005"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare batch DNS create (MX+SPF+DMARC+DKIM)"
      - endpoint: "POST /v1/zones/{zone_id}/records/batch"
        x402_price: "$0.005"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare batch DNS ops"
      - endpoint: "POST /v1/zones/{zone_id}/records"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare DNS create"
      - endpoint: "GET /v1/zones/{zone_id}/records"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare DNS list"
      - endpoint: "GET /v1/zones/{zone_id}/records/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare DNS get"
      - endpoint: "PUT /v1/zones/{zone_id}/records/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare DNS update"
      - endpoint: "DELETE /v1/zones/{zone_id}/records/{id}"
        x402_price: "$0.001"
        provider_cost: "$0.00"
        margin_pct: 100
        notes: "Cloudflare DNS delete"

# ─── Pricing Risk Summary ─────────────────────────────────────────────────
#
# HIGH RISK:
#   spawn.sh POST /v1/servers  — $0.01 charge vs $4/mo DO cost (-39,900% margin)
#     Action: needs recurring billing model (hourly/daily x402 charges or deposit)
#
#   search.sh POST /v1/extract — $0.005 charge = $0.005 Tavily cost (0% margin)
#     Action: raise to $0.01 or accept as loss leader for search bundle
#
# MODERATE RISK:
#   token.sh POST /v1/tokens   — $1.00 charge vs ~$0.10 gas (Base L2 normal)
#     90% margin normally, but mainnet gas spikes during congestion could
#     push cost above $1. Consider gas price oracle + dynamic pricing.
#
#   domain.sh POST /v1/domains/register — dynamic pricing from NameSilo
#     Margin depends on markup over registrar wholesale. Need to verify
#     markup logic covers all TLD pricing tiers.
#
# HEALTHY (90-100% margin):
#   All SQLite-only operations (wallet, store metadata, email metadata)
#   All self-hosted services (email JMAP, mem Qdrant, store R2 free tier)
#   Token read operations (free RPC calls)
#
# Infrastructure cost baseline (monthly):
#   DigitalOcean VPS: $12/mo (s-1vcpu-2gb)
#   Cloudflare: $0 (free plan — R2 free tier, DNS free, Pages free)
#   Qdrant: $0 (self-hosted on VPS)
#   Stalwart: $0 (self-hosted on VPS)
#   Tavily: $0-$100/mo (usage-based, $5/1K calls)
#   NameSilo: per-registration (pass-through)
#   Circle USDC faucet: $0 (testnet only)
